
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>[译]GO BOOTCAMP 第三章：内置类型实战 | 一线攻城狮</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Lee Hong">
    

    
    <meta name="description" content="Go内置类型实战，包括类型转换，类型断言，结构类型，结构继承等内容。">
<meta name="keywords" content="golang">
<meta property="og:type" content="article">
<meta property="og:title" content="[译]GO BOOTCAMP 第三章：内置类型实战">
<meta property="og:url" content="http://researchlab.github.io/2016/01/17/go-types/index.html">
<meta property="og:site_name" content="一线攻城狮">
<meta property="og:description" content="Go内置类型实战，包括类型转换，类型断言，结构类型，结构继承等内容。">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-04-30T08:39:14.183Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[译]GO BOOTCAMP 第三章：内置类型实战">
<meta name="twitter:description" content="Go内置类型实战，包括类型转换，类型断言，结构类型，结构继承等内容。">

    
    <link rel="alternative" href="/atom.xml" title="一线攻城狮" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="一线攻城狮">一线攻城狮</a></h1>
				<h2 class="blog-motto">十年磨一剑，一步一步脚踏实地的耕种</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:researchlab.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/17/go-types/" title="[译]GO BOOTCAMP 第三章：内置类型实战" itemprop="url">[译]GO BOOTCAMP 第三章：内置类型实战</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Lee Hong" target="_blank" itemprop="author">Lee Hong</a>
		
 <p class="article-time">
    <time datetime="2016-01-17T21:36:28.000Z" itemprop="datePublished"> 发表于 2016-01-17</time>
   &nbsp&nbsp热度&nbsp<span id="busuanzi_value_page_pv"></span>° 
  </p>
</header>

	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#基本类型"><span class="toc-number">1.</span> <span class="toc-text">基本类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#类型转换"><span class="toc-number">2.</span> <span class="toc-text">类型转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#类型断言"><span class="toc-number">3.</span> <span class="toc-text">类型断言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#结构"><span class="toc-number">4.</span> <span class="toc-text">结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#初始化"><span class="toc-number">5.</span> <span class="toc-text">初始化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组合vs继承"><span class="toc-number">6.</span> <span class="toc-text">组合vs继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#案例分析"><span class="toc-number">7.</span> <span class="toc-text">案例分析</span></a></li></ol>
		
		</div>
		
		<p><code>Go</code>内置类型实战，包括类型转换，类型断言，结构类型，结构继承等内容。<br><a id="more"></a></p>
<h2 id="基本类型"><a href="#基本类型" class="headerlink" title="基本类型"></a>基本类型</h2><p><code>Go</code>语言主要有如下内置基本类型，<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span></span><br><span class="line"><span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">Numeric types:</span><br><span class="line"></span><br><span class="line"><span class="keyword">uint</span>        either <span class="number">32</span> or <span class="number">64</span> bits</span><br><span class="line"><span class="keyword">int</span>         same size as <span class="keyword">uint</span></span><br><span class="line"><span class="keyword">uintptr</span>     an unsigned integer large enough to store the uninterpreted bits of</span><br><span class="line">            a pointer value</span><br><span class="line"><span class="keyword">uint8</span>       the set of all unsigned  <span class="number">8</span>-bit integers (<span class="number">0</span> to <span class="number">255</span>)</span><br><span class="line"><span class="keyword">uint16</span>      the set of all unsigned <span class="number">16</span>-bit integers (<span class="number">0</span> to <span class="number">65535</span>)</span><br><span class="line"><span class="keyword">uint32</span>      the set of all unsigned <span class="number">32</span>-bit integers (<span class="number">0</span> to <span class="number">4294967295</span>)</span><br><span class="line"><span class="keyword">uint64</span>      the set of all unsigned <span class="number">64</span>-bit integers (<span class="number">0</span> to <span class="number">18446744073709551615</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">int8</span>        the set of all signed  <span class="number">8</span>-bit integers (<span class="number">-128</span> to <span class="number">127</span>)</span><br><span class="line"><span class="keyword">int16</span>       the set of all signed <span class="number">16</span>-bit integers (<span class="number">-32768</span> to <span class="number">32767</span>)</span><br><span class="line"><span class="keyword">int32</span>       the set of all signed <span class="number">32</span>-bit integers (<span class="number">-2147483648</span> to <span class="number">2147483647</span>)</span><br><span class="line"><span class="keyword">int64</span>       the set of all signed <span class="number">64</span>-bit integers</span><br><span class="line">            (<span class="number">-9223372036854775808</span> to <span class="number">9223372036854775807</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">float32</span>     the set of all IEEE<span class="number">-754</span> <span class="number">32</span>-bit floating-point numbers</span><br><span class="line"><span class="keyword">float64</span>     the set of all IEEE<span class="number">-754</span> <span class="number">64</span>-bit floating-point numbers</span><br><span class="line"></span><br><span class="line"><span class="keyword">complex64</span>   the set of all <span class="built_in">complex</span> numbers with <span class="keyword">float32</span> <span class="built_in">real</span> and imaginary parts</span><br><span class="line"><span class="keyword">complex128</span>  the set of all <span class="built_in">complex</span> numbers with <span class="keyword">float64</span> <span class="built_in">real</span> and imaginary parts</span><br><span class="line"></span><br><span class="line"><span class="keyword">byte</span>        alias <span class="keyword">for</span> <span class="keyword">uint8</span></span><br><span class="line"><span class="keyword">rune</span>        alias <span class="keyword">for</span> <span class="keyword">int32</span> (represents a Unicode code point)</span><br></pre></td></tr></table></figure></p>
<p>内置类型基本使用示例，<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"math/cmplx"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	goIsFun <span class="keyword">bool</span>       = <span class="literal">true</span></span><br><span class="line">	maxInt  <span class="keyword">uint64</span>     = <span class="number">1</span>&lt;&lt;<span class="number">64</span> - <span class="number">1</span></span><br><span class="line">	<span class="built_in">complex</span> <span class="keyword">complex128</span> = cmplx.Sqrt(<span class="number">-5</span> + <span class="number">12i</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">const</span> f = <span class="string">"%T(%v)\n"</span></span><br><span class="line">	fmt.Printf(f, goIsFun, goIsFun)</span><br><span class="line">	fmt.Printf(f, maxInt, maxInt)</span><br><span class="line">	fmt.Printf(f, <span class="built_in">complex</span>, <span class="built_in">complex</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出结果:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bool(<span class="literal">true</span>)</span><br><span class="line">uint64(18446744073709551615)</span><br><span class="line">complex128((2+3i))</span><br></pre></td></tr></table></figure></p>
<h2 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h2><p><code>T(v)</code>表示将<code>v</code>的类型转换为<code>T</code>类型，一些数值类型转换如下，<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">42</span></span><br><span class="line"><span class="keyword">var</span> f <span class="keyword">float64</span> = <span class="keyword">float64</span>(i)</span><br><span class="line"><span class="keyword">var</span> u <span class="keyword">uint</span> = <span class="keyword">uint</span>(f)</span><br></pre></td></tr></table></figure></p>
<p>简化一下,<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">i := <span class="number">42</span></span><br><span class="line">f := <span class="keyword">float64</span>(i)</span><br><span class="line">u := <span class="keyword">uint</span>(f)</span><br></pre></td></tr></table></figure></p>
<p><code>Go</code>语言中不同类型之间需要显示转换才能相互赋值，如传入的参数类型与函数接收的参数不同时，需要手动进行类型转换才能传入。<br><strong>译者注:</strong> <code>Go</code>语言中除了<code>byte</code>和<code>uint8</code>之间以及<code>rune</code>和<code>int32</code>之间可以相互进行赋值操作外，其它不同类型直接都需要显示转换才能进行相互赋值操作。 如,<br>    <figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i <span class="keyword">byte</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> u <span class="keyword">uint8</span> </span><br><span class="line">u = i <span class="comment">// 可以直接赋值，不需显示转换 ，同样rune 与 int32 之间也是一样的。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> f <span class="keyword">float64</span> = <span class="keyword">float64</span>(i) <span class="comment">//这里需要显示将 int 转换float64 才能赋值成功!</span></span><br></pre></td></tr></table></figure></p>
<h2 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h2><p>如果想判断一个变量的数据类型,或将当前类型(如 interface{})作相应的类型判断,可以借助类型断言来解决。类型断言试图将当前变量转换为指定的数据类型，并返回转换之后相应的指针对象（如果转换成功）及是否转换成功的标志值。下面示例中，<code>timeMap</code>函数接受一个变量，并断言这个变量类型是否为<code>map[string]interface{}</code>类型，如果是则为其初始化一个<code>key</code>为<code>updated_at</code>,<code>value</code>为<code>time.Now()</code>的值对。<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">timeMap</span><span class="params">(y <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	z, ok := y.(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	<span class="keyword">if</span> ok &#123;</span><br><span class="line">		z[<span class="string">"updated_at"</span>] = time.Now()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	foo := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">		<span class="string">"Matt"</span>: <span class="number">42</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	timeMap(foo)</span><br><span class="line">		fmt.Println(foo)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>Go</code>语言并不对空接口<code>interface{}</code>进行类型断言，如果函数内部如对不同类型参数会作出不同的处理，则通常需借助类型断言来完成，如：<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Stringer <span class="keyword">interface</span> &#123;</span><br><span class="line">	String() <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> fakeString <span class="keyword">struct</span> &#123;</span><br><span class="line">	content <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *fakeString)</span> <span class="title">String</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> s.content</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printString</span><span class="params">(value <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	<span class="keyword">switch</span> str := value.(<span class="keyword">type</span>) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="keyword">string</span>:</span><br><span class="line">		fmt.Println(str)</span><br><span class="line">	<span class="keyword">case</span> Stringer:</span><br><span class="line">		fmt.Println(str.String())</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果给<code>printString</code>传入一个<code>fakeString</code>,因为<code>fakeString</code>实现了<code>Stringer</code>方法，那么<code>printString</code>中会处理<code>Stringer</code>这个case,如果直接传入一个字符串给<code>printString</code>，则显然会处理<code>string</code>这个case 从而直接输出传入的字符串。<br><a href="https://github.com/researchlab/go-bootcamp/blob/master/ch03/type_assertion.go" target="_blank" rel="noopener">示例代码</a><br>类型断言也可以用于判断具体的<code>error</code>类型，如:<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	  <span class="keyword">if</span> msqlerr, ok := err.(*mysql.MySQLError); ok &amp;&amp; msqlerr.Number == <span class="number">1062</span> &#123;</span><br><span class="line">	    	log.Println(<span class="string">"We got a MySQL duplicate :("</span>)</span><br><span class="line">	   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		    <span class="keyword">return</span> err</span><br><span class="line">	   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h2><p><code>struct</code>是多个字段或属性的集合，用户也可以自定义一个像<code>struct</code>或<code>interface</code>这样的数据类型。如果你学过面向对象编程，你可以将<code>struct</code>理解为一个轻量级的<code>class</code>支持字段属性的集合，但不支持继承。<code>struct</code>中默认提供<code>get</code>和<code>set</code>方法，需要注意的是只有首字母大写的<code>struct</code>变量才能被包访问。<code>struct</code>可以通过<code>Name:</code>后跟初始值来初始化<code>struct</code>,这样初始化时可以不按<code>struct</code>中字段声明的顺序进行初始化，如果在<code>struct</code>变量前加上<code>&amp;</code>符号，返回的是一个指向这个<code>struct</code>的指针对象。<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Bootcamp <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// Latitude of the event</span></span><br><span class="line">	Lat <span class="keyword">float64</span></span><br><span class="line">	<span class="comment">// Longitude of the event</span></span><br><span class="line">	Lon <span class="keyword">float64</span></span><br><span class="line">	<span class="comment">// Date of the event</span></span><br><span class="line">	Date time.Time</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(Bootcamp&#123;</span><br><span class="line">		Lat:  <span class="number">34.012836</span>,</span><br><span class="line">		Lon:  <span class="number">-118.495338</span>,</span><br><span class="line">		Date: time.Now(),</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>声明并初始化<code>struct</code>对象，<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Point <span class="keyword">struct</span> &#123;</span><br><span class="line">	X, Y <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	p = Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;  <span class="comment">// 初始化一个Point对象</span></span><br><span class="line">	q = &amp;Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125; <span class="comment">// 初始化一个Point指针对象</span></span><br><span class="line">	r = Point&#123;X: <span class="number">1</span>&#125;  <span class="comment">// Y值默认为0 </span></span><br><span class="line">	s = Point&#123;&#125;      <span class="comment">// X和Y的值都默认为0</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(p, q, r, s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/researchlab/go-bootcamp/blob/master/ch03/declaration_struct.go" target="_blank" rel="noopener">示例代码</a></p>
<p>可通过<code>.</code>符号访问<code>struct</code>中的成员变量，<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Bootcamp <span class="keyword">struct</span> &#123;</span><br><span class="line">	Lat, Lon <span class="keyword">float64</span></span><br><span class="line">	Date     time.Time</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	event := Bootcamp&#123;</span><br><span class="line">		Lat: <span class="number">34.012836</span>,</span><br><span class="line">		Lon: <span class="number">-118.495338</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	event.Date = time.Now()</span><br><span class="line">	fmt.Printf(<span class="string">"Event on %s, location (%f, %f)"</span>,event.Date, event.Lat, event.Lon)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/researchlab/go-bootcamp/blob/master/ch03/access_struct_field.go" target="_blank" rel="noopener">示例代码</a></p>
<h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><p><code>Go</code>支持用<code>new</code>表达式初始化变量，分配一个类型零值并返回指向这个类型的指针给变量。<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x := <span class="built_in">new</span>(<span class="keyword">int</span>)</span><br></pre></td></tr></table></figure></p>
<p>一种常见的初始化一个包含<code>struct</code>或引用变量的方法是创建一个<code>struct</code>字段。另一种方法是通过创建构造函数来完成初始化操作。这两种方法是当需要自定义初始化字段值常用的两种方法。下面用<code>new</code>方法和用空<code>struct</code>字段初始化一个<code>struct</code>是等价的，如:<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Bootcamp <span class="keyword">struct</span> &#123;</span><br><span class="line">	Lat <span class="keyword">float64</span></span><br><span class="line">	Lon <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	x := <span class="built_in">new</span>(Bootcamp)</span><br><span class="line">	y := &amp;Bootcamp&#123;&#125;</span><br><span class="line">	fmt.Println(*x == *y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面<code>x</code>和<code>y</code>的初始化操作是等价的；后面要接触的<code>slices</code>，<code>maps</code>和<code>channels</code>结构初始化一般需要自定义初始化字段如长度，容量等，所以这些结构通常用<code>make</code>关键字来初始化操作。</p>
<h2 id="组合vs继承"><a href="#组合vs继承" class="headerlink" title="组合vs继承"></a>组合vs继承</h2><p><code>Go</code>不支持面向对象编程中的继承操作，但是可以使用组合和接口来完成继承的操作。<code>Go</code>支持<code>OOP</code>中的组合（或者说绑定）操作。下面是一个关于地址操作的示例:<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id       <span class="keyword">int</span></span><br><span class="line">	Name     <span class="keyword">string</span></span><br><span class="line">	Location <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Player <span class="keyword">struct</span> &#123;</span><br><span class="line">	User</span><br><span class="line">	GameId   <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p := Player&#123;&#125;</span><br><span class="line">	p.Id = <span class="number">42</span></span><br><span class="line">	p.Name = <span class="string">"Matt"</span></span><br><span class="line">	p.Location = <span class="string">"LA"</span></span><br><span class="line">	p.GameId = <span class="number">90404</span></span><br><span class="line">	fmt.Printf(<span class="string">"%+v"</span>, p)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/researchlab/go-bootcamp/blob/master/ch03/composition_case.go" target="_blank" rel="noopener">示例代码</a><br>上面地址的案例是一个经典的<code>OOP</code>例子，现在考虑到<code>Player</code> struct和<code>User</code>struct有相同的字段，但是<code>Player</code>还有一个自己的<code>GameId</code>字段，用<code>OOP</code>思想则声明<code>Player</code>和<code>User</code>struct，会存在重复声明相同的字段，但是在<code>Go</code>中可以通过组合<code>struct</code>来简化这样的情况,<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id             <span class="keyword">int</span></span><br><span class="line">	Name, Location <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Player <span class="keyword">struct</span> &#123;</span><br><span class="line">	User</span><br><span class="line">	GameId <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>现在可通过两种方法来初始化一个<code>Player</code>结构。第一种使用<code>.</code>来设置<code>struct</code>字段,<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id             <span class="keyword">int</span></span><br><span class="line">	Name, Location <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Player <span class="keyword">struct</span> &#123;</span><br><span class="line">	User</span><br><span class="line">	GameId <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p := Player&#123;&#125;</span><br><span class="line">	p.Id = <span class="number">42</span></span><br><span class="line">	p.Name = <span class="string">"Matt"</span></span><br><span class="line">	p.Location = <span class="string">"LA"</span></span><br><span class="line">	p.GameId = <span class="number">90404</span></span><br><span class="line">	fmt.Printf(<span class="string">"%+v"</span>, p)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>另一种初始化方法是使用<code>struct</code>字段初始化语法<code>Name:</code>来初始化，<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id             <span class="keyword">int</span></span><br><span class="line">	Name, Location <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Player <span class="keyword">struct</span> &#123;</span><br><span class="line">	User</span><br><span class="line">	GameId <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p := Player&#123;</span><br><span class="line">	User&#123;Id: <span class="number">42</span>, Name: <span class="string">"Matt"</span>, Location: <span class="string">"LA"</span>&#125;,<span class="number">90404</span>,&#125;</span><br><span class="line">	fmt.Printf(<span class="string">"Id: %d, Name: %s, Location: %s, Game id: %d\n"</span>,	p.Id, p.Name, p.Location, p.GameId)</span><br><span class="line">	<span class="comment">// Directly set a field define on the Player struct</span></span><br><span class="line">	p.Id = <span class="number">11</span></span><br><span class="line">	fmt.Printf(<span class="string">"%+v"</span>, p)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当需要调用匿名结构中的字段时，不能直接引用相应的字段，而是需要通过当前结构对象来调用，如<code>User</code>作为匿名结构嵌入在<code>Player</code>中，所以通过<code>Player</code>对象能调用到<code>User</code>中到字段，但是不能直接通过<code>User</code>中到字段名去调用，示例如:<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id             <span class="keyword">int</span></span><br><span class="line">	Name, Location <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *User)</span> <span class="title">Greetings</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">"Hi %s from %s"</span>,u.Name, u.Location)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Player <span class="keyword">struct</span> &#123;</span><br><span class="line">	User</span><br><span class="line">	GameId <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p := Player&#123;&#125;</span><br><span class="line">	p.Id = <span class="number">42</span></span><br><span class="line">	p.Name = <span class="string">"Matt"</span></span><br><span class="line">	p.Location = <span class="string">"LA"</span></span><br><span class="line">	fmt.Println(p.Greetings())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>通过当前结构体对象引用嵌入到匿名结构体中的字段对构建数据结构非常有效，当嵌入对匿名结构实现了某个接口，那当前结构也就自动实现了这个接口了。下面来看另一个示例，<code>Job</code>结构中嵌入了<code>Logger</code>结构，那相当于<code>Job</code>也实现了<code>Logger</code>实现的了日志接口，如：<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"log"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Job <span class="keyword">struct</span> &#123;</span><br><span class="line">	Command <span class="keyword">string</span></span><br><span class="line">	Logger  *log.Logger</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	job := &amp;Job&#123;<span class="string">"demo"</span>, log.New(os.Stderr, <span class="string">"Job: "</span>, log.Ldate)&#125;</span><br><span class="line">	<span class="comment">// 也可这样初始化job</span></span><br><span class="line">	<span class="comment">// job := &amp;Job&#123;Command: "demo",</span></span><br><span class="line">    <span class="comment">//       Logger: log.New(os.Stderr, "Job: ", log.Ldate)&#125;</span></span><br><span class="line">	job.Logger.Print(<span class="string">"test"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>Job</code>结构中有个字段<code>Logger</code>是一个指向<code>log.Logger</code>类型的指针，在初始化值之后，则<code>Job</code>对象就可以通过这样来调用<code>log.Logger</code>实现的<code>Print</code>函数了，<code>job.Logger.Print()</code>。既然<code>Logger</code>本身是一个指向<code>log.Logger</code>类型的指针，那我们直接在<code>Job</code>结构中嵌入一个<code>log.Logger</code>指针对象，那<code>Job</code>结构对象不就可以直接调用<code>job.Logger</code>实现的<code>Print</code>方法？ 答案是可以的， 如:<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"log"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Job <span class="keyword">struct</span> &#123;</span><br><span class="line">	Command <span class="keyword">string</span></span><br><span class="line">	*log.Logger <span class="comment">//嵌入匿名指针类型</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	job := &amp;Job&#123;<span class="string">"demo"</span>, log.New(os.Stderr, <span class="string">"Job: "</span>, log.Ldate)&#125;</span><br><span class="line">	job.Print(<span class="string">"starting now..."</span>) <span class="comment">//直接调用log.Logger实现的Print()方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注意在使用<code>log.Logger</code>之前需要初始化，如果匿名结构实现了某个接口，也相当于使嵌入这个匿名结构的当前结构也实现了这个接口，非常方便高效。</p>
<h2 id="案例分析"><a href="#案例分析" class="headerlink" title="案例分析"></a>案例分析</h2><p>在<code>Go</code>中参数是默认是值传递,所以从上述<code>User/Player</code>示例中，你可能注意到在<code>Player</code>结构中嵌入<code>User</code>结构指针比直接嵌入<code>User</code>结构对象更好。确实如果嵌入到结构体比较简单时，使用哪种方法都差不多，如果像现实中<code>User</code>结构其实非常复杂，那选择传入引用则是更好到选择。修改上述代码如：<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id             <span class="keyword">int</span></span><br><span class="line">	Name, Location <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *User)</span> <span class="title">Greetings</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">"Hi %s from %s"</span>,u.Name, u.Location)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Player <span class="keyword">struct</span> &#123;</span><br><span class="line">	*User</span><br><span class="line">	GameId <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上述将代码修改为嵌入<code>User</code>指针，那在调用<code>User</code>中字段之后，需要对<code>User</code>先初始化，详情看<a href="https://github.com/researchlab/go-bootcamp/blob/master/ch03/pass_ptr.go" target="_blank" rel="noopener">示例代码</a></p>
<ul>
<li>Question: 为<code>User</code>结构指针类型定义一个<code>Greetings</code>方法，如何直接去调用它呢？</li>
<li>Solution:<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id             <span class="keyword">int</span></span><br><span class="line">	Name, Location <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *User)</span> <span class="title">Greetings</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">"Hi %s from %s"</span>,u.Name, u.Location)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Player <span class="keyword">struct</span> &#123;</span><br><span class="line">	*User</span><br><span class="line">	GameId <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewPlayer</span><span class="params">(id <span class="keyword">int</span>, name, location <span class="keyword">string</span>, gameId <span class="keyword">int</span>)</span> *<span class="title">Player</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;Player&#123;</span><br><span class="line">		User:   &amp;User&#123;id, name, location&#125;,</span><br><span class="line">		GameId: gameId,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p := NewPlayer(<span class="number">42</span>, <span class="string">"Matt"</span>, <span class="string">"LA"</span>, <span class="number">90404</span>)</span><br><span class="line">	fmt.Println(p.Greetings())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>上述案例通过<code>NewPlayer</code>方法在使用<code>User</code>中的<code>Greetings</code>前，先初始化了<code>User</code>结构指针,如果在使用前不初始化，则调用<code>Greetings</code>时，是用一个<code>nil ptr</code>去调用<code>Greetings</code>，显然这样调用不成功，所以使用前需要先初始化，得到返回指向这个匿名对象的地址指针对象，才能进一步通过这个指针对象去调用匿名结构中的字段属性。</p>
<p><strong> 《GO BOOTCAMP》第三章翻译完成，原著第三章出处：<a href="http://www.golangbootcamp.com/book/types" target="_blank" rel="noopener">Chapter 3 Types</a> </strong></p>
  
	</div>
		<div style="padding: 10px 44px 30px 44px;" >
<div style="border: 1px dashed #e0e0e0; padding: 10px 10px 10px 10px; background-color: #fffeee; background-repeat: no-repeat; background-attachment: scroll; background-position: 1% 50%; -moz-background-size: auto auto; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<div style="float:left;margin-top:0px;">
<img src="/img/weixin.jpg" width="125px" height="125px" style="border:1px solid #ccc; margin: 6px 5px 0px 0px"/>
</div>
<div>
 <p style="margin-top:0px;">作者署名：<b><a target="_blank" href="http://researchlab.github.io/">朴实的一线攻城狮</a></b>
<br />本文标题：<b><a href="/2016/01/17/go-types/" target="_blank" title="[译]GO BOOTCAMP 第三章：内置类型实战">[译]GO BOOTCAMP 第三章：内置类型实战</a></b> 
<br />本文出处：<b><a href="/2016/01/17/go-types/" target="_blank" title="[译]GO BOOTCAMP 第三章：内置类型实战">http://researchlab.github.io/2016/01/17/go-types/</a></b>
<br />版权声明：本文由<b><a href="/about" target="_blank" title="Lee Hong">Lee Hong</a></b>创作和发表,采用<b>署名(BY)</b>-<b>非商业性使用(NC)</b>-<b>相同方式共享(SA)</b>国际许可协议进行许可,转载请注明作者及出处, 否则保留追究法律责任的权利。 </p>
</div>
</div>
</div>

   	       
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/go-bootcamp/">go-bootcamp</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/golang/">golang</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	<div class="share-jiathis">
	  
<div class="jiathis_style_24x24">
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
	<a class="jiathis_button_tqq"></a>
	<a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_googleplus"></a>
	<a class="jiathis_button_douban"></a>
	<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
    var jiathis_config={
    data_track_clickback:true,
    sm:"copy,renren,cqq",
    pic:"",
    summary:"",
    
  </script> 
<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=
2084050" charset="utf-8"></script>      


	 </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2016/01/19/go-collection-types/" title="[译]GO BOOTCAMP 第四章：集合类型">
  <strong>上一篇：</strong><br/>
  <span>
  [译]GO BOOTCAMP 第四章：集合类型</span>
</a>
</div>


<div class="next">
<a href="/2016/01/16/go-basics/"  title="[译]GO BOOTCAMP 第二章：基本概念实战">
 <strong>下一篇：</strong><br/> 
 <span>[译]GO BOOTCAMP 第二章：基本概念实战
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2016/01/17/go-types/" data-title="[译]GO BOOTCAMP 第三章：内置类型实战" data-url="http://researchlab.github.io/2016/01/17/go-types/"></div>
</section>


</div>  

      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>
<div id="asidepart">

  <div class="widget tag">
<!--<hr noshade color="#ccc">-->
<!-- <p style="text-align:center">Mike.Lee</p> -->
<p margin="0" style="text-align:center">
<a class="ahref" href="http://researchlab.github.io/about/">
<img id="aboutpic"  src="/img/qzly.png" alt="@全栈炼狱之路" height="200" width="200" style="box-shadow: 0px 0px 2px 2px #9edeff;border-radius: 8px;" >
</a></p>
<p style="text-align:center"><font size="2" color="grey">关注微信公众号 @全栈炼狱之路</font></p>
<div style="display:block; margin-top:10px; padding: 0px 4px 4px 0; border-top: dashed 1px #ccc; text-align:left;"></div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div style="float:left;position:absolute;"><font size="2" >总访问:<span id="busuanzi_value_site_pv"></span>次</font></div>
<div style="float:right;"><font size="2" >总访客:<span id="busuanzi_value_site_uv"></span>人</font></div>

<div style="margin-top:30px; padding: 5px 4px 4px 0; border-top: dashed 1px #ccc; text-align:left;"></div>
</div>



  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/DevOps/" title="DevOps">DevOps<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/Hexo/" title="Hexo">Hexo<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/algorithm/" title="algorithm">algorithm<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/docker-practice/" title="docker-practice">docker-practice<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/go-bootcamp/" title="go-bootcamp">go-bootcamp<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/go-pattern/" title="go-pattern">go-pattern<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/golang/" title="golang">golang<sup>23</sup></a></li>
		  
		
		  
			<li><a href="/categories/javascript/" title="javascript">javascript<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/mysql专题/" title="mysql专题">mysql专题<sup>16</sup></a></li>
		  
		
		  
			<li><a href="/categories/php/" title="php">php<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/redis专题/" title="redis专题">redis专题<sup>17</sup></a></li>
		  
		
		</ul>
</div>



  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/golang/" title="golang">golang<sup>26</sup></a></li>
			
		
			
				<li><a href="/tags/mysql/" title="mysql">mysql<sup>18</sup></a></li>
			
		
			
				<li><a href="/tags/redis/" title="redis">redis<sup>17</sup></a></li>
			
		
			
				<li><a href="/tags/docker/" title="docker">docker<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/setcookie/" title="setcookie">setcookie<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/tcp/" title="tcp">tcp<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/cache/" title="cache">cache<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/concurrency/" title="concurrency">concurrency<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Blog/" title="Blog">Blog<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/getcookie/" title="getcookie">getcookie<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/rpc/" title="rpc">rpc<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/cache-invalid/" title="cache-invalid">cache-invalid<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/ticker/" title="ticker">ticker<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/vendoring/" title="vendoring">vendoring<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/godep/" title="godep">godep<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/govendor/" title="govendor">govendor<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/glide/" title="glide">glide<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/hash/" title="hash">hash<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/gin/" title="gin">gin<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://blog.csdn.net/xiaolongwang2010" target="_blank" title="小龙王2010csdn技术博客">Linux/c/c++</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=1&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=5141203275&verifier=a533edf5&dpc=1"></iframe>


</aside>
</div>

    </div>
    <footer><div id="footer" >
	
	
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/researchlab/lightman" target="_blank" title="lightman">lightman</a> ©2016 - 2019 
		
		<a href="/about" target="_blank" title="Lee Hong">Lee Hong</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>




<script type="text/javascript">
  var duoshuoQuery = {short_name:"gamedp"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
